/-
Advanced Test 2: Positivity checking exploits
Attempting to sneak negative occurrences past the positivity checker

Historical context: Coq and other systems have had bugs where complex
nested/mutual inductives could bypass positivity checking, leading to
derivation of False via encoding of Russell's paradox or similar.
-/

-- Test 1: Simple negative occurrence (should fail)
-- inductive Bad where
--   | mk : (Bad → False) → Bad

-- Test 2: Hidden negative occurrence through type alias
def Hidden := Bad2
inductive Bad2 where
  | mk : (Hidden → False) → Bad2

-- Test 3: Negative occurrence through mutual induction
mutual
  inductive Tricky1 where
    | mk : Tricky2 → Tricky1

  inductive Tricky2 where
    | mk : (Tricky1 → False) → Tricky2
end

-- Test 4: Nested inductive with hidden negativity
inductive Container (α : Type) where
  | mk : α → Container α

inductive Nested where
  | mk : Container (Nested → False) → Nested

-- Test 5: Using parameters to hide negativity
inductive Param (α : Type) (β : Type) where
  | mk : (α → β) → Param α β

inductive HiddenNeg where
  | mk : Param HiddenNeg False → HiddenNeg

-- Test 6: Mutual recursion with type parameters
mutual
  inductive MutA (α : Type) where
    | mk : MutB α → MutA α

  inductive MutB (α : Type) where
    | mk : (MutA α → α) → MutB α
end

-- Test 7: Triple mutual with circular negativity
mutual
  inductive TripleA where
    | mk : TripleB → TripleA

  inductive TripleB where
    | mk : TripleC → TripleB

  inductive TripleC where
    | mk : (TripleA → False) → TripleC
end

-- Test 8: Nested mutual with parameters
mutual
  inductive NestedMutA (α : Type) where
    | mk : NestedMutB (α → False) → NestedMutA α

  inductive NestedMutB (β : Type) where
    | mk : β → NestedMutB β
end

-- Test 9: Using type classes to hide negativity
class Hidden2 (α : Type) where
  hidden : α → False

inductive ClassBad where
  | mk : (inst : Hidden2 ClassBad) → ClassBad

-- Test 10: Proof-relevant vs proof-irrelevant mixing
inductive PropContainer (P : Prop) : Type where
  | mk : P → PropContainer P

inductive PropTrick where
  | mk : PropContainer (PropTrick → False) → PropTrick
