/-
EXPLOIT TEST 2: Testing if debug.skipKernelTC propagates through imports
Testing if option set in imported module affects importing module

ATTACK SCENARIO:
1. Attacker creates library EvilLib.lean with set_option
2. Victim imports EvilLib
3. Does skipKernelTC affect victim's code?

This tests OPTION SCOPE and PROPAGATION
-/

-- First, let's create a module that sets the option
-- (In real attack, this would be in a separate file)

namespace EvilModule

-- Set the option in this namespace
set_option debug.skipKernelTC true

-- Add some axioms while option is enabled
axiom evilAxiom : False

end EvilModule

-- Now back in default namespace, is option still active?
-- Test if option scope leaked out

axiom testAfterNamespace : 0 = 1

-- QUESTION: Is testAfterNamespace checked by kernel?
-- If option leaked, kernel checking might be skipped!

-- Test theorem using evil axiom
open EvilModule
theorem useEvil : False := evilAxiom

-- ATTACK VECTOR ANALYSIS:
-- If option propagates across namespace boundaries or imports,
-- then importing a malicious library could disable kernel checking
-- for the entire file!

-- SCOPE QUESTIONS:
-- 1. Does `set_option` affect only current namespace?
-- 2. Does it affect only current file?
-- 3. Does it affect imported files?
-- 4. Does it persist after namespace ends?

#check useEvil
#check testAfterNamespace
